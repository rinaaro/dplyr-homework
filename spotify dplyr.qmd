---
title: "spotify dplyr"
author: "Arina Agaronyan"
format: 
  html: 
    echo: false 
  pdf: 
    echo: false
---


```{r}
#| message: false
here::i_am("dplyr homework.Rproj")
library(here)
library(ggplot2)
theme_set(theme_bw())
library(dplyr)
library(tidyr)
library(knitr)
```


## Exercise 1

```{r load_spotify}
spotify <- readRDS(here("top-spotify-songs-from-20102019-by-year.Rds"))
```



### Q1

```{r q1}
n_song <- spotify %>% distinct(title)
n_artist <- spotify %>% distinct(artist)
n_genre <- spotify %>% distinct(`top genre`)
```

The data set contains `r nrow(n_song)` songs, `r nrow(n_artist)` artists, and `r nrow(n_genre)` musical genres.


### Q2


```{r n_songs_per_year}
knitr::kable(spotify %>% count(year), col.names = c("Year", "Number of songs per year"))
```


### Q3

```{r pop_artist}
n_song_all <- spotify %>% distinct(title, .keep_all = TRUE)
sp_stats <- n_song_all |>
  group_by(artist) |>
  summarise(N=n()) |>
  slice_max(order_by = N)
```


The most popular artist is `r sp_stats[1]`, with `r sp_stats[2]` individual songs on the spotify top song charts.





